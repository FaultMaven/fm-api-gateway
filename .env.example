# FaultMaven API Gateway - Environment Configuration

# ============================================================================
# Service Discovery Configuration (Deployment-Neutral)
# ============================================================================
# Deployment mode: "docker" (default), "kubernetes", or "local"
DEPLOYMENT_MODE=docker

# Kubernetes namespace (only used when DEPLOYMENT_MODE=kubernetes)
K8S_NAMESPACE=faultmaven

# ============================================================================
# Legacy Service URL Overrides (Optional - for backward compatibility)
# ============================================================================
# If set, these will override ServiceRegistry auto-discovery
# In most cases, you should rely on ServiceRegistry instead
# FM_AUTH_SERVICE_URL=http://fm-auth-service:8000
# FM_SESSION_SERVICE_URL=http://fm-session-service:8002
# FM_CASE_SERVICE_URL=http://fm-case-service:8005
# FM_EVIDENCE_SERVICE_URL=http://fm-evidence-service:8004
# FM_INVESTIGATION_SERVICE_URL=http://fm-investigation-service:8006
# FM_KNOWLEDGE_SERVICE_URL=http://fm-knowledge-service:8003
# FM_AGENT_SERVICE_URL=http://fm-agent-service:8001

# ============================================================================
# Authentication Configuration
# ============================================================================
# Primary auth provider: "fm-auth-service" (default), "supabase", or "auth0"
PRIMARY_AUTH_PROVIDER=fm-auth-service

# Whether to require authentication (set to false for local dev/testing)
AUTH_REQUIRED=true

# Anonymous user configuration (when AUTH_REQUIRED=false)
ANONYMOUS_USER_ID=anonymous_admin
ANONYMOUS_USER_EMAIL=admin@example.com
ANONYMOUS_USER_ROLE=admin

# JWK cache TTL in seconds (default: 300 = 5 minutes)
JWK_CACHE_TTL=300

# ============================================================================
# Gateway Server Configuration
# ============================================================================
GATEWAY_HOST=0.0.0.0
GATEWAY_PORT=8090

# ============================================================================
# CORS Configuration
# ============================================================================
# Comma-separated list of allowed CORS origins
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8090

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=INFO

# ============================================================================
# Redis Configuration (for rate limiting and circuit breakers)
# ============================================================================
# Redis mode: "standalone" (default) or "sentinel" (HA)
REDIS_MODE=standalone

# Standalone Redis configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Sentinel configuration (when REDIS_MODE=sentinel)
# REDIS_SENTINEL_HOSTS=localhost:26379,localhost:26380,localhost:26381
# REDIS_MASTER_SET=mymaster

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
# Enable rate limiting (default: true)
RATE_LIMIT_ENABLED=true

# Maximum requests per minute per IP (default: 60)
RATE_LIMIT_REQUESTS_PER_MINUTE=60

# ============================================================================
# Circuit Breaker Configuration
# ============================================================================
# Enable circuit breaker (default: true)
CIRCUIT_BREAKER_ENABLED=true

# Number of consecutive failures before opening circuit (default: 5)
CIRCUIT_BREAKER_FAIL_THRESHOLD=5

# Seconds to wait before attempting recovery (default: 30)
CIRCUIT_BREAKER_RESET_TIMEOUT=30
